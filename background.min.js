function getStyleId(t){return"previewer-font-"+t.replace(/[^a-z0-9]/gi,"_")}function wrapSelector(t){return"html"===(t=t.trim()).toLowerCase()?"html.previewerForGoogleFonts":"html.previewerForGoogleFonts "+t}function buildCustomCss(t,e,o,n,r,i){let l=`${t}{font-family:'${e}' !important; font-weight:${o} !important;`;return n&&""!==n.trim()&&"null"!==n&&(l+=` font-style:${n} !important;`),r&&""!==r.trim()&&(l+=` font-size:${r}${i} !important;`),l+="}",l}chrome.tabs.onUpdated.addListener(((t,e,o)=>{if("complete"===e.status&&o.url){let e;try{e=new URL(o.url)}catch(t){return}const n=e.host;chrome.storage.local.get(["keepApplied_"+n,"selectedFonts_"+n],(e=>{const o=e["keepApplied_"+n],r=e["selectedFonts_"+n]||{};if(o)for(const e in r)if(r.hasOwnProperty(e)){const{fontFamily:o,fontWeight:n,fontStyle:i,fontSize:l,fontSizeUnit:s}=r[e],c="italic"===i?1:0,a="https://fonts.googleapis.com/css2?family="+encodeURIComponent(o)+":ital,wght@"+c+","+n;fetch(a).then((t=>t.text())).then((r=>{const c=r+buildCustomCss(wrapSelector(e),o,n,i,l,s),a=getStyleId(e);chrome.scripting.executeScript({target:{tabId:t},func:(t,e)=>{let o=document.getElementById(e);o||(o=document.createElement("style"),o.id=e,document.head.appendChild(o)),o.textContent=t,document.documentElement.classList.add("previewerForGoogleFonts")},args:[c,a]})})).catch((t=>console.error(t)))}}))}}));